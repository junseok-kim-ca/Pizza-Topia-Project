# Overview 
Welcome to my analysis of Pizza Topia's (fictional company) sales data, aimed at uncovering trends, customer preferences, and revenue opportunities. This project analyzes over 48,000 rows of transactional data using MySQL and MySQL Workbench to address key business questions.

By exploring metrics such as revenue trends, order volumes, and customer behavior patterns, the analysis reveals insights like top-selling pizzas, revenue contributions by category, peak sales times, repeat orders, and average order sizes.

üîç Want to view the complete SQL queries? Check them out here: [Pizza Topia SQL Project](1_Pizza_Topia_SQL_Project.sql)

# Pizza Topia Dataset

The dataset used for this project is generated by AI (Chat-GPT) and simulates real-world pizza sales orders for the fictional company, Pizza Topia. It offers a comprehensive view of pizza ordering details, making it a valuable resource for exploring sales trends, customer preferences, and pricing strategies.

üîç Curious about Pizza Topia's dataset? Explore the complete sales data here: [Pizza Topia Dataset](2_pizza_topia_sales.csv)

It includes detailed information on:

- **Pizza Details**:  
  Unique pizza IDs, names, sizes, categories (e.g., Classic, Veggie, Supreme), and the ingredients used in each pizza.

- **Order Information**:  
  Order IDs, quantities ordered, along with dates and times‚Äîideal for time-series analysis of sales activities.

- **Pricing Data**:  
  Unit prices and total prices for every pizza order, which can support revenue analysis and pricing strategy evaluation.

# Questions To Analyze: 
1. What is the total revenue generated from all pizza sales?
2. What is the average value of each order based on total pizza sales?
3. On average, how many pizzas are included in each order?
4. Which pizzas are most frequently included in repeat orders, and how many repeat orders does each have?
5. What is the total revenue and revenue percentage contribution of each pizza category?
6. What are the top three pizzas in terms of revenue, their respective categories, and their percentage contribution to total pizza sales revenue?
7. Which pizzas are the most ordered during weekdays and weekends, along with their categories and total orders?
8. During which hours are the highest number of orders placed, and what is the total revenue generated during those hours?
9. On which days of the week do pizza sales generate the highest revenue, and how many orders are placed on those days?
10. How do pizza sales compare between weekdays and weekends in terms of total orders and revenue?
11. Which months generate the highest pizza sales revenue, and how many orders are placed during those months? 
    

# Tools 
To ensure effective and insightful analysis, I leveraged the following tools:
1. **MySQL**: The trusted relational database management system, enabling efficient storage, management, and retrieval of data for analysis.
2. **MySQL Workbench**: The versatile GUI tool for designing, modeling, and managing MySQL databases. It simplifies database interactions, offering a user-friendly environment for writing and executing queries, visualizing schemas, and monitoring server performance.


# Data Preparation & Cleanup 
This section describes the steps involved in preparing the data for analysis, ensuring its accuracy and reliability for use.

## Data Import 
I created a database and table, and since the dataset contains over 48,000 rows, I used the `LOAD DATA INFILE` query. This method is widely recognized as one of the fastest and most efficient ways to load large volumes of data into a database table.

```sql
CREATE DATABASE IF NOT EXISTS pizza_db;
USE pizza_db;

CREATE TABLE pizza_sales (
    pizza_id INT NOT NULL PRIMARY KEY,
    order_id INT,
    pizza_name_id VARCHAR(50),
    quantity INT,
    order_date VARCHAR(50), -- We will change the database format, YYYY-MM-DD and change DATE datatype later
    order_time TIME,
    unit_price DECIMAL(10, 2),
    total_price DECIMAL(10, 2),
    pizza_size CHAR(3),
    pizza_category VARCHAR(50),
    pizza_ingredients TEXT,
    pizza_name VARCHAR(255) 
);

LOAD DATA INFILE 'C:\\Project 2\\pizza_sales.csv'
INTO TABLE pizza_sales
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\r\n'
IGNORE 1 LINES 
(
    pizza_id,
    order_id,
    pizza_name_id,
    quantity,
    order_date,
    order_time,
    unit_price,
    total_price,
    pizza_size,
    pizza_category,
    pizza_ingredients,
    pizza_name
);
```

## Data Exploration
I begin by running a series of SQL queries to gain an initial understanding of the pizza_sales dataset, focusing on its size, uniqueness of key features, and the time range of data collection. This helps establish the foundational structure and scope of the data before further analysis.

```sql
SELECT
    COUNT(*) AS total_rows
FROM 
    pizza_sales; -- There are 48620 rows in this dataset

SELECT 
    COUNT(DISTINCT pizza_name) AS unique_pizza_items
FROM 
    pizza_sales; -- there are 32 unique pizza items in Pizza Topia

SELECT 
    MIN(order_date) AS earliest_order_date,
    MAX(order_date) AS latest_order_date
FROM 
    pizza_sales; -- The data was collected from Jan 1, 2015 until Dec 31, 2015
```

## Data Cleaning 
In this stage, I corrected data types and standardized text data to ensure more accurate analysis in the future. Additionally, I addressed missing and duplicate data to enhance overall data integrity.

### Fixing Data Types & Text Data 

```sql
UPDATE pizza_sales
SET
    order_date = STR_TO_DATE(order_date, '%d-%m-%Y')
WHERE
    order_date IS NOT NULL; -- modify date format DD-MM-YYYY to YYYY-MM-DD

ALTER TABLE pizza_sales
MODIFY order_date DATE; -- change VARCHAR to DATE data type 

SELECT 
    pizza_name
FROM 
    pizza_sales
WHERE
    pizza_name REGEXP '[!@#$%^&*()_+=\\[\\]{}|;:"<>?/\\`~]'; -- Match any single character that is a punctuation symbol from the list provided.

UPDATE pizza_sales
SET
    pizza_ingredients = REPLACE(pizza_ingredients, '?duja Salami', '''Nduja Salami')
WHERE
    pizza_ingredients LIKE '%?duja Salami%'; -- Update '?duja Salami' to 'Nduja Salami'
```

### Handling Missing & Duplicate data

```sql
SELECT 
    * 
FROM 
    pizza_sales
WHERE 
    pizza_id IS NULL 
    OR order_id IS NULL
    OR pizza_name_id IS NULL
    OR quantity IS NULL
    OR order_date IS NULL
    OR order_time IS NULL
    OR unit_price IS NULL
    OR total_price IS NULL
    OR pizza_size IS NULL
    OR pizza_category IS NULL
    OR pizza_ingredients IS NULL
    OR pizza_name IS NULL; -- There is no NULL values in all columns

SELECT 
    *,
    COUNT(*) AS duplicate_count
FROM 
    pizza_sales
GROUP BY 
    pizza_id,
    order_id,
    pizza_name_id,
    quantity,
    order_date,
    order_time,
    unit_price,
    total_price,
    pizza_size,
    pizza_category,
    pizza_ingredients,
    pizza_name
HAVING 
    COUNT(*) > 1; -- There are no duplicate rows 
```


# Analysis 
For this project, each query was designed to explore specific requirements of Pizza Topia. Here's the approach I took for addressing each question:

### 1. Total Revenue from pizza sales
To evaluate the overall revenue generated by pizza sales, I summed up the total_price column from the pizza_sales table, providing a clear snapshot of the total revenue. 

```sql
SELECT
    ROUND(SUM(total_price), 0) AS total_revenue
FROM 
    pizza_sales;
```
| total_revenue |
|---------------|
| 817860        |


### 2. Average order value (AOV) of Pizza Topia
To assess customer spending patterns, I calculated the average order value by dividing the total revenue by the number of unique orders. This query calculates the average revenue per order, offering insights into customer spending habits. 

```sql
SELECT
    ROUND(SUM(total_price) / COUNT(DISTINCT order_id), 2) AS avg_order_value
FROM 
    pizza_sales;
```
| avg_order_value  |        
|------------------|
| 38.31  |  

### 3. Average Number of Pizzas per Order
To understand customer purchasing habits, this query calculates the average number of pizzas per order by dividing total pizzas sold by unique orders, revealing typical order sizes.

```sql
SELECT
    ROUND(SUM(quantity) / COUNT(DISTINCT order_id), 0) AS avg_pizza_per_order
FROM 
    pizza_sales; -- 2

```
| avg_pizza_per_order  |        
|------------------|
| 2 |  

### 4. Repeat orders by each pizzas (ordered by highest to lowest) 
I calculated the number of unique repeat orders for each pizza in order to identify customer loyalty and preferences. This query highlightes the most frequently reordered pizzas. 

```sql
WITH repeat_orders AS (
    SELECT
        pizza_name,
        order_id,
        COUNT(order_id) AS total_order
    FROM 
        pizza_sales
    GROUP BY 
        pizza_name,
        order_id
    HAVING 
        COUNT(order_id) > 1 
)
SELECT
    pizza_name,
    COUNT(DISTINCT order_id) AS total_repeat_order -- Use the DISTINCT operator to ensure the count is accurate and to prevent duplicate entries from inflating the results
FROM 
    repeat_orders
GROUP BY 
    pizza_name
ORDER BY
    total_repeat_order DESC;

```
| Pizza Name                       | Pizza Category | Total Repeat Orders |
|----------------------------------|----------------|---------------------|
| The California Chicken Pizza     | Chicken        | 102                 |
| The Barbecue Chicken Pizza       | Chicken        | 98                  |
| The Pepperoni Pizza              | Classic        | 89                  |
| ...                              | ...            | ...                 |
| The Green Garden Pizza           | Veggie         | 11                  |
| The Mediterranean Pizza          | Veggie         | 11                  |
| The Calabrese Pizza              | Supreme        | 9                   |

***Key Findings***
1. The California Chicken Pizza leads significantly with 102 repeat orders, making it the most popular pizza among returning customers.
2. Pizzas like The Calabrese Pizza (9 orders), The Mediterranean Pizza (11 orders), and The Green Garden Pizza (11 orders) have fewer repeat orders.
3. Vegetarian pizzas such as The Vegetables Pizza (44 orders) and The Green Garden Pizza (11 orders) show lower repeat rates compared to chicken-based pizzas.  


### 5. Revenue and Percentage Contribution by Pizza Category
To evaluate revenue distribution, I calculated the total revenue generated by each pizza category and its percentage contribution to overall revenue. This helps identify the most profitable categories. 


```sql
WITH total_pizza_revenue AS (
    SELECT
        SUM(total_price) AS total_revenue
    FROM 
        pizza_sales
)
SELECT
    pizza_category,
    ROUND(SUM(total_price), 0) AS category_total_revenue,
    ROUND(SUM(total_price) / (SELECT tpr.total_revenue FROM total_pizza_revenue tpr) * 100, 0) AS category_revenue_pct
FROM 
    pizza_sales
GROUP BY 
    pizza_category
ORDER BY 
    category_total_revenue DESC;
```
| pizza_category | category_total_revenue | category_revenue_pct |
|----------------|-------------------------|-----------------------|
| Classic        | 220053                 | 27                   |
| Supreme        | 208197                 | 25                   |
| Chicken        | 195920                 | 24                   |
| Veggie         | 193690                 | 24                   |

***Key Findings***
1. Classic Pizza (27% of total revenue) is the most profitable category, indicating strong customer preference.
2. Veggie Pizza (24% of total revenue) is the least profitable category, though the gap with Classic Pizza is not significantly large.


### 6. Top Three Pizzas by Revenue, Categories, and Contribution to Total Sales
To understand the contribution of indiviaul pizzas to overall revenue, the query calculates the percentage of total revenue each top pizza generates, providing insights into their financial impact. 

```sql
WITH pizza_total_revenue AS (
    SELECT 
        SUM(total_price) AS total_revenue
    FROM 
        pizza_sales
),
revenue_rank AS (
    SELECT
        pizza_name,
        pizza_category,
        SUM(total_price) AS pizza_revenue,
        ROW_NUMBER() OVER (
            ORDER BY SUM(total_price) DESC
        ) AS row_num
    FROM 
        pizza_sales
    GROUP BY 
        pizza_name,
        pizza_category
)
SELECT
    rr.pizza_name,
    rr.pizza_category,
    ROUND(rr.pizza_revenue, 0) AS pizza_revenue,
    ROUND((rr.pizza_revenue / ptr.total_revenue * 100), 1) AS pizza_revenue_pct
FROM 
    revenue_rank rr
CROSS JOIN
    pizza_total_revenue ptr
WHERE
    rr.row_num <= 3
ORDER BY 
    rr.pizza_revenue DESC;
```
| pizza_name                 | pizza_category | pizza_revenue | pizza_revenue_pct |
| -------------------------- | -------------- | ------------- | ----------------- |
| The Thai Chicken Pizza     | Chicken        | 43434         | 5.3               |
| The Barbecue Chicken Pizza | Chicken        | 42768         | 5.2               |
| The California Chicken Pizza | Chicken      | 41410         | 5.1               |

***Key Findings***
1. The Thai Chicken Pizza (5.3% of total revenue) is the top performer, indicating that its unique flavors and ingredients strongly appeal to customers.
2. The top 3 pizzas all belong to the Chicken category, emphasizing the strong customer preference for this segment. 


### 7. Most Ordered Pizzas on Weekdays vs. Weekends 
To analyze customer ordering patterens, this query identifies the most popular pizza on weekdays and weekends by ranking pizzas based on total orders for each day type. 

```sql
WITH day_summary AS (
    SELECT
        pizza_name_id,
        pizza_category,
        CASE
            WHEN DAYOFWEEK(order_date) IN (1, 7) THEN 'Weekend' -- Sunday (1) and Saturday (7)
            ELSE 'Weekday'
        END AS day_type,
        COUNT(*) AS total_order
    FROM
        pizza_sales 
    GROUP BY 
        day_type,
        pizza_name_id,
        pizza_category
),
top_pizza AS (
    SELECT
        pizza_name_id,
        day_type,
        total_order,
        pizza_category,
        ROW_NUMBER() OVER (
            PARTITION BY day_type
            ORDER BY total_order DESC 
        ) AS row_num
    FROM 
        day_summary
)
SELECT
    pizza_name_id,
    pizza_category,
    day_type,
    total_order
FROM 
    top_pizza
WHERE
    row_num = 1;
```
| pizza_name_id | pizza_category | day_type | total_order |
|---------------|----------------|----------|-------------|
| big_meat_s    | Classic        | Weekday  | 1283        |
| big_meat_s    | Classic        | Weekend  | 528         |

***Key Findings***
1. The Big Meat Pizza (S) dominates both Weekdays and Weekends in terms of order volumn, showing its consistent popularity. 
2. Weekday orders for this pizza (1,283) are more than double those on weekends (528). This might indicate other competing pizzas or dining preferences may be more dominant on weekends.


### 8. Peak Hours for Pizza Orders and Revenue Generated
To analyze peak ordering times, this query groups orders by the hour and calculates both total orders and revenue, identifying the most profitable times of day. 

```sql
SELECT
    HOUR(order_time) AS hour_of_order,
    COUNT(order_id) AS total_order,
    SUM(total_price) AS total_revenue
FROM 
    pizza_sales
GROUP BY 
    hour_of_order
ORDER BY 
    total_revenue DESC;
```
| hour_of_order | total_order | total_revenue |
|---------------|-------------|---------------|
| 12            | 6543        | 111877.90     |
| 13            | 6203        | 106065.70     |
| 18            | 5359        | 89296.85      |
| ...           | ...         | ...           |
| 22            | 1370        | 22815.15      |
| 23            | 68          | 1121.35       |
| 9             | 4           | 83.00         |

***Key Findings***
1. The 12 PM - 1 PM window contributes the highest revenue, highlighing the importance of catering to the lunchtime crowd
2. The 5 PM - 7 PM window sees consistent revenue and order volumne, indicating a high demand during dinner hours.
3. At late night, and early morning (11 PM, 9 AM, 10 AM), customers are unlikely to place orders, emphasizing  periods of low demand.


### 9. Highest Revenue-Generating Days of the Week and Pizza Orders
In order to identify the most profitable days, this query calculates total orders and revenue for each day of the week, ranking them by revenue. 

```sql
SELECT
    DAYNAME(order_date) AS day_of_week,
    COUNT(order_id) AS total_order,
    SUM(total_price) AS total_revenue
FROM 
    pizza_sales
GROUP BY 
    day_of_week
ORDER BY
    total_revenue DESC;
    -- FIELD(day_of_week, 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');
```
| day_of_week | total_order | total_revenue  |
|-------------|-------------|----------------|
| Friday      | 8106        | 136073.90      |
| Thursday    | 7323        | 123528.50      |
| Saturday    | 7355        | 123182.40      |
| Wednesday   | 6797        | 114408.40      |
| Tuesday     | 6753        | 114133.80      |
| Monday      | 6369        | 107329.55      |
| Sunday      | 5917        | 99203.50       |

***Key Findings***
1. Friday is the most profitable day ($136,073.90 total revenue), likely due to end-of-week celebrations, office events, or families opting for convenient meals.
2. Sunday is the least profitable day ($99,203.50), potentially due to customers preparing for the upcoming workweek.


### 10. Weekday vs. Weekend Pizza Sales: Total Orders and Revenue Comparison
To compare sales performance between weekdays and weekends, I calculated total revenue and order volume for each period, revealing overall trends. 

```sql
SELECT
    CASE 
        WHEN DAYOFWEEK(order_date) IN (1, 7) THEN 'Weekend'
        ELSE 'Weekday'
    END AS day_name,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM 
    pizza_sales
GROUP BY 
    day_name
ORDER BY 
    total_revenue DESC;
```
| day_name | total_orders | total_revenue  |
|----------|--------------|----------------|
| Weekday  | 35348        | 595474.15      |
| Weekend  | 13272        | 222385.90      |

***Key Findings***
1. Weekdays contribute approximately 70% of total revenue, showing a much higher order volumn and revenue compared to weekends
2. While lower in comparison, weekends still acount for approximately 30% of total revenue, reflecting steady demand



### 11. Highest Revenue-Generating Months and Order Counts
To analyze monthly performance, I calculated total order volume and revenue for each month, ranking them by revenue to identify peak periods. 

```sql
SELECT
    CASE
        WHEN MONTH(order_date) = 1 THEN 'Jan'
        WHEN MONTH(order_date) = 2 THEN 'Feb'
        WHEN MONTH(order_date) = 3 THEN 'Mar'
        WHEN MONTH(order_date) = 4 THEN 'Apr'
        WHEN MONTH(order_date) = 5 THEN 'May'
        WHEN MONTH(order_date) = 6 THEN 'Jun'
        WHEN MONTH(order_date) = 7 THEN 'Jul'
        WHEN MONTH(order_date) = 8 THEN 'Aug'
        WHEN MONTH(order_date) = 9 THEN 'Sep'
        WHEN MONTH(order_date) = 10 THEN 'Oct'
        WHEN MONTH(order_date) = 11 THEN 'Nov'
        WHEN MONTH(order_date) = 12 THEN 'Dec'
    END AS order_month,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM 
    pizza_sales
GROUP BY 
    order_month
ORDER BY 
    total_revenue DESC;
    -- FIELD(order_month, 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec');
```
| order_month | total_orders | total_revenue |
|-------------|--------------|---------------|
| Jul         | 4301         | 72557.90      |
| May         | 4239         | 71402.75      |
| Mar         | 4186         | 70397.10      |
| ...         | ...          | ...           |
| Feb         | 3892         | 65159.60      |
| Dec         | 3859         | 64701.15      |
| Oct         | 3797         | 64027.60      |

***Key Findings***
1. July is the highest revenue month, possibly due to summer events, vacations, and increased social gatherings
2. Although October and December align with popular holidays such as Columbus Day, Halloween, and Christmas, they are among the lowest in revenue, potentially due to competition with other seasonal dining options.
3. Despite Valentine's Day, it recorded lower revenue ($65, 159.60), suggesting pizza might not be a top choice for this occasion. In addition, February‚Äôs shorter duration (28 or 29 days) likely contributes to fewer total orders and lower revenue compared to other months.



# Insights
This project provided several general insights into Pizza Topia:

1. **Repeat orders by each pizzas (ordered by highest to lowest)**: Chicken-based pizzas appear to have the highest repeat orders, suggesting they are a crowd favorite and could be a significant revenue driver.

2. **Revenue and Percentage Contribution by Pizza Category**: No single category completely dominates; all are within a 3% margin in terms of contribution to total revenue. 

3. **Top Three Pizzas by Revenue, Categories, and Contribution to Total Sales**:  Chicken pizzas collectively contribute a significant portion of revenue, making this a key focus area for sustaining and growing sales. 

4. **Most Ordered Pizzas on Weekdays vs. Weekends**: Weekday orders for this pizza (1,283) are more than twice the weekend orders (528), suggesting that other competing pizzas or shifting dining preferences may take precedence during weekends.

5. **Peak Hours for Pizza Orders and Revenue Generated**: Lunch and dinner times generate the highest revenue due to a high volume of orders, indicating that Pizza Topia is well-prepared with efficient ingredient management, staffing, and operational workflows to meet customer demand effectively. 

6. **Highest Revenue-Generating Days of the Week and Pizza Orders**: Thursday to Saturday are peak revenue days, reflecting social dining and weekend-related orders. 

7. **Weekday vs. Weekend Pizza Sales Total Orders and Revenue Comparison**: Weekday sales are significantly higher, likely due to steady workday routines and larger customer segments such as office workers and students. In contrast, weekends are less busy but still present valuable opportunities for targeted promotions to capture a different customer base.

8. **Highest Revenue-Generating Months and Order Counts**:  Despite notable holidays in February, October, and December, total revenues are lower compared to other months. To boost sales during these periods, Pizza Topia could introduce holiday-targeted promotions, such as offering heart-shaped pizzas for Valentine's Day or themed deals for Halloween and Christmas.


# What I learned
Throughout this project, I significantly enhanced my SQL skills and developed a deeper understanding of data analysis for business insights. Here's how:

1. **Complex Query Crafting**:
Mastered the use of `CTEs (Common Table Expressions)` to simplify complex queries and break down analytical challenges into manageable steps. This allowed for cleaner, more modular query writing. Additionally, I gained proficiency in using window functions like `ROW_NUMBER()` to rank and filter data within partitions, enabling advanced insights such as identifying top-selling pizzas by category and determining the most popular items for weekdays versus weekends.

2. **Data Aggregation**:
Refined my ability to use `GROUP BY` and aggregate functions like `SUM(), AVG(), COUNT()`, and `ROW_NUMBER()` to extract meaningful insights, such as identifying top-selling pizzas, peak sales periods, and revenue contributions by category.

3. **Business Insight Generation**:
Converted raw data into actionable insights by crafting SQL queries that addressed real-world business questions, such as identifying customer preferences, high-performing products, and sales patterns.


# Conclusion 
This project refined my SQL skills and uncovered key insights into Pizza Topia's sales performance. Analysis revealed that chicken-based pizzas dominate repeat orders and revenue, while weekdays and peak lunch hours drive the highest sales. Leveraging these trends can help Pizza Topia optimize inventory, marketing, and operations.

The findings highlight the importance of data-driven strategies for maximizing revenue and meeting customer preferences. By focusing on high-performing products and addressing areas like low-demand pizzas or underperforming months, Pizza Topia can further enhance its business outcomes.

This project reinforces the critical role of SQL and analytics in uncovering actionable insights and guiding business decisions. Continuous learning and adaptation to emerging trends are essential for maintaining a competitive edge.

